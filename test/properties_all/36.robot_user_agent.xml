<beginning>
<embedded_functions><![CDATA[

#include <string.h>
#include <stdio.h>
#include <stdlib.h>
#include <inttypes.h>
#include "types_defs.h"
#include <sys/time.h>
#include "hash_table_str.h"

static inline int em_check_malicious_UA(const char * UA){
   	int handle = 0;
   	if(search_hash_str(Str2DataItem(UA)->key) != NULL) handle = 1;  
	return handle;
  }
]]></embedded_functions>

<!-- Property 36: Detection of robot, crawler, spider, spam and bad bot based on blacklisted User-Agent strings (hash-table). 528 signatures from the source: http://www.user-agents.org/ -->
<property value="THEN" delay_units="ms" delay_min="0" delay_max="0" property_id="36" type_property="ATTACK" 
    description="Detection of robot, crawler, spider, spam and bad bot based on blacklisted User-Agent strings (hash-table)">
    <event value="COMPUTE" event_id="1" 
           description="HTTP User-Agent string representing robot, crawler, spider, spam and bad bot"
           boolean_expression="(#em_check_malicious_UA(http.user_agent) == 1)"/>
    <event value="COMPUTE" event_id="2" 
           description="HTTP GET"
           boolean_expression="(http.method == 'GET')"/> 
</property>
</beginning>