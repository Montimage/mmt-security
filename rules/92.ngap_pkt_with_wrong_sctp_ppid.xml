<beginning>

<!--
This rule detects whether SCTP packets contain payload other than NGAP.

Signature: to check whether "data_ppid" field of SCTP is differed 
  - from 60 which is used to indicate NGAP
  - and from 46 which is used to indicate DIAMETER

To generate attack traffic: 
  https://github.com/Montimage/5Greplay/blob/main/rules/11.modify-sctp-params.xml
 -->

<property value="THEN" delay_units="ms" delay_min="0" delay_max="0" property_id="92" type_property="ATTACK" 
    description="NGAP packet with wrong SCTP Protocol Identifier">
    <event value="COMPUTE" event_id="1" 
        description="SCTP payload is existing"
           boolean_expression="((sctp.packet_count != 0))"/>
           
   <event value="COMPUTE" event_id="2" 
      description="SCTP Protocol Identifier different from 60"
         boolean_expression="((sctp_data.data_ppid != 60) &amp;&amp; (sctp_data.data_ppid != 46))"/>
  
</property>
</beginning>


