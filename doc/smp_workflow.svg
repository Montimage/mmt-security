<svg id="mermaidChart324" width="100%" xmlns="http://www.w3.org/2000/svg" height="100%" style="max-width:1050px;" viewBox="-50 -10 1050 1241"><style type="text/css" title="mermaid-svg-internal-css">/*  */
*, ::before, ::after { box-sizing: inherit;}
.actor { stroke: rgb(204, 204, 255); fill: rgb(226, 236, 255);}
text.actor { fill: black; stroke: none; font-size: 12px;}
.actor-line { stroke: grey;}
.messageLine0 { stroke-width: 1.5; stroke: black;}
.messageLine1 { stroke-width: 1.5; stroke: black;}
#arrowhead { fill: black;}
.messageText { fill: black; stroke: none; font-size: 12px;}
.labelBox { stroke: rgb(204, 204, 255); fill: rgb(236, 236, 255);}
.labelText { fill: black; stroke: none;}
.loopText { fill: black; stroke: none;}
.loopLine { stroke-width: 2; stroke: rgb(204, 204, 255);}
.actor { stroke: rgb(204, 204, 255); fill: rgb(236, 236, 255);}
text.actor { fill: black; stroke: none;}
.actor-line { stroke: grey;}
.messageLine0 { stroke-width: 1.5; stroke: rgb(51, 51, 51);}
.messageLine1 { stroke-width: 1.5; stroke: rgb(51, 51, 51);}
#arrowhead { fill: rgb(51, 51, 51);}
#crosshead path { fill: rgb(51, 51, 51) !important; stroke: rgb(51, 51, 51) !important;}
.messageText { fill: rgb(51, 51, 51); stroke: none;}
.labelBox { stroke: rgb(204, 204, 255); fill: rgb(236, 236, 255);}
.labelText { fill: black; stroke: none;}
.loopText { fill: black; stroke: none;}
.loopLine { stroke-width: 2; stroke: rgb(204, 204, 255);}
text { font-family: "trebuchet ms", verdana, arial; font-size: 14px;}
/*  */
</style><g></g><g><line id="actor1640" x1="75" y1="5" x2="75" y2="1230" class="actor-line" stroke-width="0.5px" stroke="#999"></line><rect x="0" y="0" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="75" y="37.5" class="actor" style="text-anchor: middle;">User</text></g><g><line id="actor1641" x1="275" y1="5" x2="275" y2="1230" class="actor-line" stroke-width="0.5px" stroke="#999"></line><rect x="200" y="0" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="275" y="37.5" class="actor" style="text-anchor: middle;">mmt_security</text></g><g><line id="actor1642" x1="475" y1="5" x2="475" y2="1230" class="actor-line" stroke-width="0.5px" stroke="#999"></line><rect x="400" y="0" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="475" y="37.5" class="actor" style="text-anchor: middle;">mmt_smp_security</text></g><g><line id="actor1643" x1="675" y1="5" x2="675" y2="1230" class="actor-line" stroke-width="0.5px" stroke="#999"></line><rect x="600" y="0" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="675" y="37.5" class="actor" style="text-anchor: middle;">mmt_single_security</text></g><g><line id="actor1644" x1="875" y1="5" x2="875" y2="1230" class="actor-line" stroke-width="0.5px" stroke="#999"></line><rect x="800" y="0" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="875" y="37.5" class="actor" style="text-anchor: middle;">rule_verif_engine</text></g><defs><marker id="arrowhead" refX="5" refY="2" markerWidth="6" markerHeight="4" orient="auto"><path d="M 0,0 V 4 L6,2 Z"></path></marker></defs><defs><marker id="crosshead" markerWidth="15" markerHeight="8" orient="auto" refX="16" refY="4"><path fill="black" stroke="#000000" stroke-width="1px" d="M 9,2 V 6 L16,4 Z" style="stroke-dasharray: 0, 0;"></path><path fill="none" stroke="#000000" stroke-width="1px" d="M 0,1 L 6,7 M 6,1 L 0,7" style="stroke-dasharray: 0, 0;"></path></marker></defs><g><text x="175" y="93" class="messageText" style="text-anchor: middle;">mmt_sec_init()</text><line x1="75" y1="100" x2="275" y2="100" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><rect x="270" y="102" fill="#f4f4f4" stroke="#666" width="10" height="1043" rx="0" ry="0"></rect></g><g><text x="172.5" y="128" class="messageText" style="text-anchor: middle;">mmt_sec_register()</text><line x1="75" y1="135" x2="270" y2="135" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><text x="377.5" y="163" class="messageText" style="text-anchor: middle;">mmt_smp_sec_register()</text><line x1="280" y1="170" x2="475" y2="170" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><rect x="470" y="172" fill="#f4f4f4" stroke="#666" width="10" height="903" rx="0" ry="0"></rect></g><g><text x="577.5" y="223" class="messageText" style="text-anchor: middle;">mmt_single_sec_register</text><line x1="480" y1="230" x2="675" y2="230" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><rect x="670" y="232" fill="#f4f4f4" stroke="#666" width="10" height="798" rx="0" ry="0"></rect></g><g><text x="777.5" y="283" class="messageText" style="text-anchor: middle;">rule_engine_init</text><line x1="680" y1="290" x2="875" y2="290" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><rect x="870" y="292" fill="#f4f4f4" stroke="#666" width="10" height="693" rx="0" ry="0"></rect></g><g><line x1="660" y1="240" x2="885" y2="240" stroke-width="2" stroke="#526e52" class="loopLine"></line><line x1="885" y1="240" x2="885" y2="300" stroke-width="2" stroke="#526e52" class="loopLine"></line><line x1="660" y1="300" x2="885" y2="300" stroke-width="2" stroke="#526e52" class="loopLine"></line><line x1="660" y1="240" x2="660" y2="300" stroke-width="2" stroke="#526e52" class="loopLine"></line><rect x="660" y="240" fill="#526e52" stroke="none" width="50" height="20" rx="0" ry="0" class="labelBox"></rect><text x="667.5" y="255" fill="white" class="labelText"><tspan x="667.5">loop</tspan></text><text x="772.5" y="255" fill="black" class="loopText" style="text-anchor: middle;"><tspan x="772.5">[ for each rule ]</tspan></text></g><g><line x1="460" y1="180" x2="895" y2="180" stroke-width="2" stroke="#526e52" class="loopLine"></line><line x1="895" y1="180" x2="895" y2="310" stroke-width="2" stroke="#526e52" class="loopLine"></line><line x1="460" y1="310" x2="895" y2="310" stroke-width="2" stroke="#526e52" class="loopLine"></line><line x1="460" y1="180" x2="460" y2="310" stroke-width="2" stroke="#526e52" class="loopLine"></line><rect x="460" y="180" fill="#526e52" stroke="none" width="50" height="20" rx="0" ry="0" class="labelBox"></rect><text x="467.5" y="195" fill="white" class="labelText"><tspan x="467.5">loop</tspan></text><text x="677.5" y="195" fill="black" class="loopText" style="text-anchor: middle;"><tspan x="677.5">[ for each thread ]</tspan></text></g><g><text x="172.5" y="363" class="messageText" style="text-anchor: middle;">mmt_sec_process(message)</text><line x1="75" y1="370" x2="270" y2="370" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><text x="375" y="398" class="messageText" style="text-anchor: middle;">mmt_smp_sec_process (message)</text><line x1="280" y1="405" x2="470" y2="405" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><text x="480" y="433" class="messageText" style="text-anchor: middle;">ring_push(message)</text><path d="M 480,440 C 540,430 540,470 480,460" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></path></g><g><line x1="65" y1="320" x2="590" y2="320" stroke-width="2" stroke="#526e52" class="loopLine"></line><line x1="590" y1="320" x2="590" y2="480" stroke-width="2" stroke="#526e52" class="loopLine"></line><line x1="65" y1="480" x2="590" y2="480" stroke-width="2" stroke="#526e52" class="loopLine"></line><line x1="65" y1="320" x2="65" y2="480" stroke-width="2" stroke="#526e52" class="loopLine"></line><rect x="65" y="320" fill="#526e52" stroke="none" width="50" height="20" rx="0" ry="0" class="labelBox"></rect><text x="72.5" y="335" fill="white" class="labelText"><tspan x="72.5">loop</tspan></text><text x="327.5" y="335" fill="black" class="loopText" style="text-anchor: middle;"><tspan x="327.5">[ for each message ]</tspan></text></g><g><text x="575" y="533" class="messageText" style="text-anchor: middle;">ring_pop_burst( messages )</text><line x1="670" y1="540" x2="480" y2="540" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><text x="575" y="593" class="messageText" style="text-anchor: middle;">mmt_single_sec_process( m )</text><line x1="480" y1="600" x2="670" y2="600" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><text x="775" y="653" class="messageText" style="text-anchor: middle;">rule_engine_process( m )</text><line x1="680" y1="660" x2="870" y2="660" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><text x="775" y="688" class="messageText" style="text-anchor: middle;">verdict</text><line x1="870" y1="695" x2="680" y2="695" class="messageLine1" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="stroke-dasharray: 3, 3; fill: none;"></line></g><g><text x="372.5" y="748" class="messageText" style="text-anchor: middle;">callback( verdict )</text><line x1="670" y1="755" x2="75" y2="755" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><line x1="65" y1="705" x2="690" y2="705" stroke-width="2" stroke="#526e52" class="loopLine"></line><line x1="690" y1="705" x2="690" y2="765" stroke-width="2" stroke="#526e52" class="loopLine"></line><line x1="65" y1="765" x2="690" y2="765" stroke-width="2" stroke="#526e52" class="loopLine"></line><line x1="65" y1="705" x2="65" y2="765" stroke-width="2" stroke="#526e52" class="loopLine"></line><rect x="65" y="705" fill="#526e52" stroke="none" width="50" height="20" rx="0" ry="0" class="labelBox"></rect><text x="72.5" y="720" fill="white" class="labelText"><tspan x="72.5">opt</tspan></text><text x="377.5" y="720" fill="black" class="loopText" style="text-anchor: middle;"><tspan x="377.5">[ verdict != unknown ]</tspan></text></g><g><line x1="55" y1="610" x2="890" y2="610" stroke-width="2" stroke="#526e52" class="loopLine"></line><line x1="890" y1="610" x2="890" y2="775" stroke-width="2" stroke="#526e52" class="loopLine"></line><line x1="55" y1="775" x2="890" y2="775" stroke-width="2" stroke="#526e52" class="loopLine"></line><line x1="55" y1="610" x2="55" y2="775" stroke-width="2" stroke="#526e52" class="loopLine"></line><rect x="55" y="610" fill="#526e52" stroke="none" width="50" height="20" rx="0" ry="0" class="labelBox"></rect><text x="62.5" y="625" fill="white" class="labelText"><tspan x="62.5">loop</tspan></text><text x="472.5" y="625" fill="black" class="loopText" style="text-anchor: middle;"><tspan x="472.5">[ for each rule ]</tspan></text></g><g><line x1="45" y1="550" x2="900" y2="550" stroke-width="2" stroke="#526e52" class="loopLine"></line><line x1="900" y1="550" x2="900" y2="785" stroke-width="2" stroke="#526e52" class="loopLine"></line><line x1="45" y1="785" x2="900" y2="785" stroke-width="2" stroke="#526e52" class="loopLine"></line><line x1="45" y1="550" x2="45" y2="785" stroke-width="2" stroke="#526e52" class="loopLine"></line><rect x="45" y="550" fill="#526e52" stroke="none" width="50" height="20" rx="0" ry="0" class="labelBox"></rect><text x="52.5" y="565" fill="white" class="labelText"><tspan x="52.5">loop</tspan></text><text x="472.5" y="565" fill="black" class="loopText" style="text-anchor: middle;"><tspan x="472.5">[ for each m in messages ]</tspan></text></g><g><line x1="35" y1="490" x2="910" y2="490" stroke-width="2" stroke="#526e52" class="loopLine"></line><line x1="910" y1="490" x2="910" y2="795" stroke-width="2" stroke="#526e52" class="loopLine"></line><line x1="35" y1="795" x2="910" y2="795" stroke-width="2" stroke="#526e52" class="loopLine"></line><line x1="35" y1="490" x2="35" y2="795" stroke-width="2" stroke="#526e52" class="loopLine"></line><rect x="35" y="490" fill="#526e52" stroke="none" width="50" height="20" rx="0" ry="0" class="labelBox"></rect><text x="42.5" y="505" fill="white" class="labelText"><tspan x="42.5">loop</tspan></text><text x="472.5" y="505" fill="black" class="loopText" style="text-anchor: middle;"><tspan x="472.5">[ forever ]</tspan></text></g><g><text x="172.5" y="823" class="messageText" style="text-anchor: middle;">mmt_sec_unregister</text><line x1="75" y1="830" x2="270" y2="830" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><text x="375" y="858" class="messageText" style="text-anchor: middle;">mmt_smp_sec_unregister</text><line x1="280" y1="865" x2="470" y2="865" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><text x="575" y="918" class="messageText" style="text-anchor: middle;">mmt_single_sec_unregister</text><line x1="480" y1="925" x2="670" y2="925" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><text x="775" y="978" class="messageText" style="text-anchor: middle;">rule_engine_free</text><line x1="680" y1="985" x2="870" y2="985" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><line x1="660" y1="935" x2="890" y2="935" stroke-width="2" stroke="#526e52" class="loopLine"></line><line x1="890" y1="935" x2="890" y2="995" stroke-width="2" stroke="#526e52" class="loopLine"></line><line x1="660" y1="995" x2="890" y2="995" stroke-width="2" stroke="#526e52" class="loopLine"></line><line x1="660" y1="935" x2="660" y2="995" stroke-width="2" stroke="#526e52" class="loopLine"></line><rect x="660" y="935" fill="#526e52" stroke="none" width="50" height="20" rx="0" ry="0" class="labelBox"></rect><text x="667.5" y="950" fill="white" class="labelText"><tspan x="667.5">loop</tspan></text><text x="775" y="950" fill="black" class="loopText" style="text-anchor: middle;"><tspan x="775">[ for each rule ]</tspan></text></g><g><text x="575" y="1023" class="messageText" style="text-anchor: middle;">alerts_count of each thread</text><line x1="670" y1="1030" x2="480" y2="1030" class="messageLine1" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="stroke-dasharray: 3, 3; fill: none;"></line></g><g><line x1="460" y1="875" x2="900" y2="875" stroke-width="2" stroke="#526e52" class="loopLine"></line><line x1="900" y1="875" x2="900" y2="1040" stroke-width="2" stroke="#526e52" class="loopLine"></line><line x1="460" y1="1040" x2="900" y2="1040" stroke-width="2" stroke="#526e52" class="loopLine"></line><line x1="460" y1="875" x2="460" y2="1040" stroke-width="2" stroke="#526e52" class="loopLine"></line><rect x="460" y="875" fill="#526e52" stroke="none" width="50" height="20" rx="0" ry="0" class="labelBox"></rect><text x="467.5" y="890" fill="white" class="labelText"><tspan x="467.5">loop</tspan></text><text x="680" y="890" fill="black" class="loopText" style="text-anchor: middle;"><tspan x="680">[ for each thread ]</tspan></text></g><g><text x="375" y="1068" class="messageText" style="text-anchor: middle;">total alerts_count</text><line x1="470" y1="1075" x2="280" y2="1075" class="messageLine1" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="stroke-dasharray: 3, 3; fill: none;"></line></g><g><text x="172.5" y="1103" class="messageText" style="text-anchor: middle;">total alerts_count</text><line x1="270" y1="1110" x2="75" y2="1110" class="messageLine1" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="stroke-dasharray: 3, 3; fill: none;"></line></g><g><text x="172.5" y="1138" class="messageText" style="text-anchor: middle;">mmt_sec_close()</text><line x1="75" y1="1145" x2="270" y2="1145" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><rect x="0" y="1165" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="75" y="1202.5" class="actor" style="text-anchor: middle;">User</text></g><g><rect x="200" y="1165" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="275" y="1202.5" class="actor" style="text-anchor: middle;">mmt_security</text></g><g><rect x="400" y="1165" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="475" y="1202.5" class="actor" style="text-anchor: middle;">mmt_smp_security</text></g><g><rect x="600" y="1165" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="675" y="1202.5" class="actor" style="text-anchor: middle;">mmt_single_security</text></g><g><rect x="800" y="1165" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="875" y="1202.5" class="actor" style="text-anchor: middle;">rule_verif_engine</text></g></svg>