<?xml version="1.0" encoding="ISO-8859-1"?>
<!-- MMT_Security Copyright (C) 2016-->
<beginning>


<embedded_functions><![CDATA[
//each function name should be prefixed by em_

#include <string.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <inttypes.h>
#include "types_defs.h"

/**
* Return:
* - 0: ok
* - 1: invalid
* - 2: NULL
*/
static inline int check_URI(const char *uri_str){
  int handle = 0;
  if(uri_str == NULL){
    return 0;
  }
 
  const char *x = uri_str;
  
  //fprintf(stderr, "%s\n",x);
  while (*x != '\0'){
      //octets 0-32 (0-20 hex) | "\" | """ | "&" | "<" | ">" | "[" | "]" | "^" | "`" | "{" | "|" | "}" | "~" | octets 127-255 (7F-FF hex)
      if(*x < 32 || *x == 92 || *x == '"' || *x == '<' || *x == '>' || *x == '[' || *x == ']' || *x == '^' || *x == '`' || *x == '{' || 
         *x == '|' || *x == '}' || *x == '%' || *x > 126) {
              handle = 1;
              break;
      }
      x = x+1;
  }
  //detect directory traversal attack
  char *s0, *s1, *s2, *s3;
  s0 = strstr(uri_str, ".."); //find the first occurrence of string ".." in string
  if( s0 != NULL ) return 1;
  s1 = strstr(uri_str, "./"); //find the first occurrence of string "./" in string
  if( s1 != NULL ) return 1;
  s2 = strstr(uri_str, "//"); //find the first occurrence of string "//" in string
  if( s2 != NULL ) return 1;
  s3 = strstr(uri_str, "/."); //find the first occurrence of string "//" in string
  if( s3 != NULL ) return 1;
  //if ((s0 !=NULL) || (s1 !=NULL) || (s2 !=NULL) || (s3 !=NULL))  
  // handle = 1;
   
//#ifdef DEBUG
//  fprintf(stderr, "executing ceck_URI with parameters:h=%d:nb=%u:a1=%o:a2=%o\n", 
//                                           handle, *(char*)(BLOC3+6),*(char*)(BLOC3+9));
//#endif
  return handle;
}

/*
 * Nikto 
 */
static inline bool check_UA( const char *user_agent){
   //find the first occurrence of string "Nikto" in string
   return (strstr(user_agent, "Nikto") != NULL);     
}

]]></embedded_functions>


<!-- Property 10: C4_Analyse_03f : HTTP detecte avec un port different de 80 et 8080.-->
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="501" type_property="EVASION" 
    description="C4_Analyse_03f : HTTP using a port different from 80 and 8080.">
    <event value="COMPUTE" event_id="1" 
        description="HTTP packet using a port different from 80 and 8080"
           boolean_expression="((http.method != '')&amp;&amp;((tcp.dest_port != 80)&amp;&amp;(tcp.dest_port != 8080)))"/>
    <event value="COMPUTE" event_id="2" 
           description="HTTP packet"
           boolean_expression="(ip.src != ip.dst)"/>
</property>

<!-- Property 12: C4_Analyse_03c|d|e : l URI d un paquet HTTP contient des caracteres non authorises.-->
<!-- URN invalid character set:
     octets 0-32 (0-20 hex) | "\" | """ | "&" | "<" | ">" | "[" | "]" | "^" | "`" | "{" | "|" | "}" | "~" | octets 127-255 (7F-FF hex)
-->
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="502" type_property="EVASION" 
    description="C4_Analyse_03c|d|e : HTTP packet URI contains non authorised characteres according to RFC2396 and RFC2234 or possibly directory traversal attack.">
    <event value="COMPUTE" event_id="1" 
           description="HTTP URI invalid"
           boolean_expression="((http.method == http.method)&amp;&amp;(#check_URI(http.uri) == 1))"/>
    <event value="COMPUTE" event_id="2" 
           description="HTTP packet"
           boolean_expression="(ip.src != ip.dst)"/>
</property>

<!-- Property 15: C4_Analyse_02 : Web scan with Nikto. User-Agent based detection
           boolean_expression="((http.user_agent == '')||(#check_UA(http.user_agent) == 1))"/>
-->
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="503" type_property="ATTACK" 
     description="Nikto detection" >
   <event event_id="1" value="COMPUTE" 
           description="Context: an  user agent in the HTTP header"
           boolean_expression="(#check_UA(http.user_agent) == 1)"/>
   <event event_id="2" value="COMPUTE" 
           description="Trigger: Nikto detected. "
           boolean_expression="(ip.src != ip.dst)"/>
 </property>


<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="504" type_property="EVASION" 
    description="C4_Analyse_03f : HTTP using a port different from 80 and 8080.">
    <event value="COMPUTE" event_id="1" 
        description="HTTP packet using a port different from 80 and 8080"
           boolean_expression="((http.method != '')&amp;&amp;((tcp.dest_port != 80)&amp;&amp;(tcp.dest_port != 8080)))"/>
    <event value="COMPUTE" event_id="2" 
           description="HTTP packet"
           boolean_expression="(ip.src != ip.dst)"/>
</property>
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="505" type_property="EVASION" 
    description="C4_Analyse_03c|d|e : HTTP packet URI contains non authorised characteres according to RFC2396 and RFC2234 or possibly directory traversal attack.">
    <event value="COMPUTE" event_id="1" 
           description="HTTP URI invalid"
           boolean_expression="((http.method == http.method)&amp;&amp;(#check_URI(http.uri) == 1))"/>
    <event value="COMPUTE" event_id="2" 
           description="HTTP packet"
           boolean_expression="(ip.src != ip.dst)"/>
</property>
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="506" type_property="ATTACK" 
     description="Nikto detection" >
   <event event_id="1" value="COMPUTE" 
           description="Context: an  user agent in the HTTP header"
           boolean_expression="(#check_UA(http.user_agent) == 1)"/>
   <event event_id="2" value="COMPUTE" 
           description="Trigger: Nikto detected. "
           boolean_expression="(ip.src != ip.dst)"/>
 </property>
 
 
 <property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="507" type_property="EVASION" 
    description="C4_Analyse_03f : HTTP using a port different from 80 and 8080.">
    <event value="COMPUTE" event_id="1" 
        description="HTTP packet using a port different from 80 and 8080"
           boolean_expression="((http.method != '')&amp;&amp;((tcp.dest_port != 80)&amp;&amp;(tcp.dest_port != 8080)))"/>
    <event value="COMPUTE" event_id="2" 
           description="HTTP packet"
           boolean_expression="(ip.src != ip.dst)"/>
</property>
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="508" type_property="EVASION" 
    description="C4_Analyse_03c|d|e : HTTP packet URI contains non authorised characteres according to RFC2396 and RFC2234 or possibly directory traversal attack.">
    <event value="COMPUTE" event_id="1" 
           description="HTTP URI invalid"
           boolean_expression="((http.method == http.method)&amp;&amp;(#check_URI(http.uri) == 1))"/>
    <event value="COMPUTE" event_id="2" 
           description="HTTP packet"
           boolean_expression="(ip.src != ip.dst)"/>
</property>
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="509" type_property="ATTACK" 
     description="Nikto detection" >
   <event event_id="1" value="COMPUTE" 
           description="Context: an  user agent in the HTTP header"
           boolean_expression="(#check_UA(http.user_agent) == 1)"/>
   <event event_id="2" value="COMPUTE" 
           description="Trigger: Nikto detected. "
           boolean_expression="(ip.src != ip.dst)"/>
 </property>
 
 
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5010" type_property="EVASION" 
    description="C4_Analyse_03f : HTTP using a port different from 80 and 8080.">
    <event value="COMPUTE" event_id="1" 
        description="HTTP packet using a port different from 80 and 8080"
           boolean_expression="((http.method != '')&amp;&amp;((tcp.dest_port != 80)&amp;&amp;(tcp.dest_port != 8080)))"/>
    <event value="COMPUTE" event_id="2" 
           description="HTTP packet"
           boolean_expression="(ip.src != ip.dst)"/>
</property>
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5011" type_property="EVASION" 
    description="C4_Analyse_03c|d|e : HTTP packet URI contains non authorised characteres according to RFC2396 and RFC2234 or possibly directory traversal attack.">
    <event value="COMPUTE" event_id="1" 
           description="HTTP URI invalid"
           boolean_expression="((http.method == http.method)&amp;&amp;(#check_URI(http.uri) == 1))"/>
    <event value="COMPUTE" event_id="2" 
           description="HTTP packet"
           boolean_expression="(ip.src != ip.dst)"/>
</property>
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5012" type_property="ATTACK" 
     description="Nikto detection" >
   <event event_id="1" value="COMPUTE" 
           description="Context: an  user agent in the HTTP header"
           boolean_expression="(#check_UA(http.user_agent) == 1)"/>
   <event event_id="2" value="COMPUTE" 
           description="Trigger: Nikto detected. "
           boolean_expression="(ip.src != ip.dst)"/>
 </property>
 
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5013" type_property="EVASION" 
    description="C4_Analyse_03f : HTTP using a port different from 80 and 8080.">
    <event value="COMPUTE" event_id="1" 
        description="HTTP packet using a port different from 80 and 8080"
           boolean_expression="((http.method != '')&amp;&amp;((tcp.dest_port != 80)&amp;&amp;(tcp.dest_port != 8080)))"/>
    <event value="COMPUTE" event_id="2" 
           description="HTTP packet"
           boolean_expression="(ip.src != ip.dst)"/>
</property>
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5014" type_property="EVASION" 
    description="C4_Analyse_03c|d|e : HTTP packet URI contains non authorised characteres according to RFC2396 and RFC2234 or possibly directory traversal attack.">
    <event value="COMPUTE" event_id="1" 
           description="HTTP URI invalid"
           boolean_expression="((http.method == http.method)&amp;&amp;(#check_URI(http.uri) == 1))"/>
    <event value="COMPUTE" event_id="2" 
           description="HTTP packet"
           boolean_expression="(ip.src != ip.dst)"/>
</property>
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5015" type_property="ATTACK" 
     description="Nikto detection" >
   <event event_id="1" value="COMPUTE" 
           description="Context: an  user agent in the HTTP header"
           boolean_expression="(#check_UA(http.user_agent) == 1)"/>
   <event event_id="2" value="COMPUTE" 
           description="Trigger: Nikto detected. "
           boolean_expression="(ip.src != ip.dst)"/>
 </property>
 
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5016" type_property="EVASION" 
    description="C4_Analyse_03f : HTTP using a port different from 80 and 8080.">
    <event value="COMPUTE" event_id="1" 
        description="HTTP packet using a port different from 80 and 8080"
           boolean_expression="((http.method != '')&amp;&amp;((tcp.dest_port != 80)&amp;&amp;(tcp.dest_port != 8080)))"/>
    <event value="COMPUTE" event_id="2" 
           description="HTTP packet"
           boolean_expression="(ip.src != ip.dst)"/>
</property>
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5017" type_property="EVASION" 
    description="C4_Analyse_03c|d|e : HTTP packet URI contains non authorised characteres according to RFC2396 and RFC2234 or possibly directory traversal attack.">
    <event value="COMPUTE" event_id="1" 
           description="HTTP URI invalid"
           boolean_expression="((http.method == http.method)&amp;&amp;(#check_URI(http.uri) == 1))"/>
    <event value="COMPUTE" event_id="2" 
           description="HTTP packet"
           boolean_expression="(ip.src != ip.dst)"/>
</property>
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5018" type_property="ATTACK" 
     description="Nikto detection" >
   <event event_id="1" value="COMPUTE" 
           description="Context: an  user agent in the HTTP header"
           boolean_expression="(#check_UA(http.user_agent) == 1)"/>
   <event event_id="2" value="COMPUTE" 
           description="Trigger: Nikto detected. "
           boolean_expression="(ip.src != ip.dst)"/>
 </property>
 
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5019" type_property="EVASION" 
    description="C4_Analyse_03f : HTTP using a port different from 80 and 8080.">
    <event value="COMPUTE" event_id="1" 
        description="HTTP packet using a port different from 80 and 8080"
           boolean_expression="((http.method != '')&amp;&amp;((tcp.dest_port != 80)&amp;&amp;(tcp.dest_port != 8080)))"/>
    <event value="COMPUTE" event_id="2" 
           description="HTTP packet"
           boolean_expression="(ip.src != ip.dst)"/>
</property>
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5020" type_property="EVASION" 
    description="C4_Analyse_03c|d|e : HTTP packet URI contains non authorised characteres according to RFC2396 and RFC2234 or possibly directory traversal attack.">
    <event value="COMPUTE" event_id="1" 
           description="HTTP URI invalid"
           boolean_expression="((http.method == http.method)&amp;&amp;(#check_URI(http.uri) == 1))"/>
    <event value="COMPUTE" event_id="2" 
           description="HTTP packet"
           boolean_expression="(ip.src != ip.dst)"/>
</property>
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5021" type_property="ATTACK" 
     description="Nikto detection" >
   <event event_id="1" value="COMPUTE" 
           description="Context: an  user agent in the HTTP header"
           boolean_expression="(#check_UA(http.user_agent) == 1)"/>
   <event event_id="2" value="COMPUTE" 
           description="Trigger: Nikto detected. "
           boolean_expression="(ip.src != ip.dst)"/>
 </property>
 
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5022" type_property="EVASION" 
    description="C4_Analyse_03f : HTTP using a port different from 80 and 8080.">
    <event value="COMPUTE" event_id="1" 
        description="HTTP packet using a port different from 80 and 8080"
           boolean_expression="((http.method != '')&amp;&amp;((tcp.dest_port != 80)&amp;&amp;(tcp.dest_port != 8080)))"/>
    <event value="COMPUTE" event_id="2" 
           description="HTTP packet"
           boolean_expression="(ip.src != ip.dst)"/>
</property>
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5023" type_property="EVASION" 
    description="C4_Analyse_03c|d|e : HTTP packet URI contains non authorised characteres according to RFC2396 and RFC2234 or possibly directory traversal attack.">
    <event value="COMPUTE" event_id="1" 
           description="HTTP URI invalid"
           boolean_expression="((http.method == http.method)&amp;&amp;(#check_URI(http.uri) == 1))"/>
    <event value="COMPUTE" event_id="2" 
           description="HTTP packet"
           boolean_expression="(ip.src != ip.dst)"/>
</property>
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5024" type_property="ATTACK" 
     description="Nikto detection" >
   <event event_id="1" value="COMPUTE" 
           description="Context: an  user agent in the HTTP header"
           boolean_expression="(#check_UA(http.user_agent) == 1)"/>
   <event event_id="2" value="COMPUTE" 
           description="Trigger: Nikto detected. "
           boolean_expression="(ip.src != ip.dst)"/>
 </property>
 
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5025" type_property="EVASION" 
    description="C4_Analyse_03f : HTTP using a port different from 80 and 8080.">
    <event value="COMPUTE" event_id="1" 
        description="HTTP packet using a port different from 80 and 8080"
           boolean_expression="((http.method != '')&amp;&amp;((tcp.dest_port != 80)&amp;&amp;(tcp.dest_port != 8080)))"/>
    <event value="COMPUTE" event_id="2" 
           description="HTTP packet"
           boolean_expression="(ip.src != ip.dst)"/>
</property>
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5026" type_property="EVASION" 
    description="C4_Analyse_03c|d|e : HTTP packet URI contains non authorised characteres according to RFC2396 and RFC2234 or possibly directory traversal attack.">
    <event value="COMPUTE" event_id="1" 
           description="HTTP URI invalid"
           boolean_expression="((http.method == http.method)&amp;&amp;(#check_URI(http.uri) == 1))"/>
    <event value="COMPUTE" event_id="2" 
           description="HTTP packet"
           boolean_expression="(ip.src != ip.dst)"/>
</property>
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5027" type_property="ATTACK" 
     description="Nikto detection" >
   <event event_id="1" value="COMPUTE" 
           description="Context: an  user agent in the HTTP header"
           boolean_expression="(#check_UA(http.user_agent) == 1)"/>
   <event event_id="2" value="COMPUTE" 
           description="Trigger: Nikto detected. "
           boolean_expression="(ip.src != ip.dst)"/>
 </property>
 
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5028" type_property="EVASION" 
    description="C4_Analyse_03f : HTTP using a port different from 80 and 8080.">
    <event value="COMPUTE" event_id="1" 
        description="HTTP packet using a port different from 80 and 8080"
           boolean_expression="((http.method != '')&amp;&amp;((tcp.dest_port != 80)&amp;&amp;(tcp.dest_port != 8080)))"/>
    <event value="COMPUTE" event_id="2" 
           description="HTTP packet"
           boolean_expression="(ip.src != ip.dst)"/>
</property>
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5029" type_property="EVASION" 
    description="C4_Analyse_03c|d|e : HTTP packet URI contains non authorised characteres according to RFC2396 and RFC2234 or possibly directory traversal attack.">
    <event value="COMPUTE" event_id="1" 
           description="HTTP URI invalid"
           boolean_expression="((http.method == http.method)&amp;&amp;(#check_URI(http.uri) == 1))"/>
    <event value="COMPUTE" event_id="2" 
           description="HTTP packet"
           boolean_expression="(ip.src != ip.dst)"/>
</property>
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5030" type_property="ATTACK" 
     description="Nikto detection" >
   <event event_id="1" value="COMPUTE" 
           description="Context: an  user agent in the HTTP header"
           boolean_expression="(#check_UA(http.user_agent) == 1)"/>
   <event event_id="2" value="COMPUTE" 
           description="Trigger: Nikto detected. "
           boolean_expression="(ip.src != ip.dst)"/>
 </property>
 
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5031" type_property="EVASION" 
    description="C4_Analyse_03f : HTTP using a port different from 80 and 8080.">
    <event value="COMPUTE" event_id="1" 
        description="HTTP packet using a port different from 80 and 8080"
           boolean_expression="((http.method != '')&amp;&amp;((tcp.dest_port != 80)&amp;&amp;(tcp.dest_port != 8080)))"/>
    <event value="COMPUTE" event_id="2" 
           description="HTTP packet"
           boolean_expression="(ip.src != ip.dst)"/>
</property>
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5032" type_property="EVASION" 
    description="C4_Analyse_03c|d|e : HTTP packet URI contains non authorised characteres according to RFC2396 and RFC2234 or possibly directory traversal attack.">
    <event value="COMPUTE" event_id="1" 
           description="HTTP URI invalid"
           boolean_expression="((http.method == http.method)&amp;&amp;(#check_URI(http.uri) == 1))"/>
    <event value="COMPUTE" event_id="2" 
           description="HTTP packet"
           boolean_expression="(ip.src != ip.dst)"/>
</property>
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5033" type_property="ATTACK" 
     description="Nikto detection" >
   <event event_id="1" value="COMPUTE" 
           description="Context: an  user agent in the HTTP header"
           boolean_expression="(#check_UA(http.user_agent) == 1)"/>
   <event event_id="2" value="COMPUTE" 
           description="Trigger: Nikto detected. "
           boolean_expression="(ip.src != ip.dst)"/>
 </property>
 
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5034" type_property="EVASION" 
    description="C4_Analyse_03f : HTTP using a port different from 80 and 8080.">
    <event value="COMPUTE" event_id="1" 
        description="HTTP packet using a port different from 80 and 8080"
           boolean_expression="((http.method != '')&amp;&amp;((tcp.dest_port != 80)&amp;&amp;(tcp.dest_port != 8080)))"/>
    <event value="COMPUTE" event_id="2" 
           description="HTTP packet"
           boolean_expression="(ip.src != ip.dst)"/>
</property>
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5035" type_property="EVASION" 
    description="C4_Analyse_03c|d|e : HTTP packet URI contains non authorised characteres according to RFC2396 and RFC2234 or possibly directory traversal attack.">
    <event value="COMPUTE" event_id="1" 
           description="HTTP URI invalid"
           boolean_expression="((http.method == http.method)&amp;&amp;(#check_URI(http.uri) == 1))"/>
    <event value="COMPUTE" event_id="2" 
           description="HTTP packet"
           boolean_expression="(ip.src != ip.dst)"/>
</property>
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5036" type_property="ATTACK" 
     description="Nikto detection" >
   <event event_id="1" value="COMPUTE" 
           description="Context: an  user agent in the HTTP header"
           boolean_expression="(#check_UA(http.user_agent) == 1)"/>
   <event event_id="2" value="COMPUTE" 
           description="Trigger: Nikto detected. "
           boolean_expression="(ip.src != ip.dst)"/>
 </property>
 
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5037" type_property="EVASION" 
    description="C4_Analyse_03f : HTTP using a port different from 80 and 8080.">
    <event value="COMPUTE" event_id="1" 
        description="HTTP packet using a port different from 80 and 8080"
           boolean_expression="((http.method != '')&amp;&amp;((tcp.dest_port != 80)&amp;&amp;(tcp.dest_port != 8080)))"/>
    <event value="COMPUTE" event_id="2" 
           description="HTTP packet"
           boolean_expression="(ip.src != ip.dst)"/>
</property>
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5038" type_property="EVASION" 
    description="C4_Analyse_03c|d|e : HTTP packet URI contains non authorised characteres according to RFC2396 and RFC2234 or possibly directory traversal attack.">
    <event value="COMPUTE" event_id="1" 
           description="HTTP URI invalid"
           boolean_expression="((http.method == http.method)&amp;&amp;(#check_URI(http.uri) == 1))"/>
    <event value="COMPUTE" event_id="2" 
           description="HTTP packet"
           boolean_expression="(ip.src != ip.dst)"/>
</property>
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5039" type_property="ATTACK" 
     description="Nikto detection" >
   <event event_id="1" value="COMPUTE" 
           description="Context: an  user agent in the HTTP header"
           boolean_expression="(#check_UA(http.user_agent) == 1)"/>
   <event event_id="2" value="COMPUTE" 
           description="Trigger: Nikto detected. "
           boolean_expression="(ip.src != ip.dst)"/>
 </property>
 
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5040" type_property="EVASION" 
    description="C4_Analyse_03f : HTTP using a port different from 80 and 8080.">
    <event value="COMPUTE" event_id="1" 
        description="HTTP packet using a port different from 80 and 8080"
           boolean_expression="((http.method != '')&amp;&amp;((tcp.dest_port != 80)&amp;&amp;(tcp.dest_port != 8080)))"/>
    <event value="COMPUTE" event_id="2" 
           description="HTTP packet"
           boolean_expression="(ip.src != ip.dst)"/>
</property>
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5041" type_property="EVASION" 
    description="C4_Analyse_03c|d|e : HTTP packet URI contains non authorised characteres according to RFC2396 and RFC2234 or possibly directory traversal attack.">
    <event value="COMPUTE" event_id="1" 
           description="HTTP URI invalid"
           boolean_expression="((http.method == http.method)&amp;&amp;(#check_URI(http.uri) == 1))"/>
    <event value="COMPUTE" event_id="2" 
           description="HTTP packet"
           boolean_expression="(ip.src != ip.dst)"/>
</property>
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5042" type_property="ATTACK" 
     description="Nikto detection" >
   <event event_id="1" value="COMPUTE" 
           description="Context: an  user agent in the HTTP header"
           boolean_expression="(#check_UA(http.user_agent) == 1)"/>
   <event event_id="2" value="COMPUTE" 
           description="Trigger: Nikto detected. "
           boolean_expression="(ip.src != ip.dst)"/>
 </property>
 
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5043" type_property="EVASION" 
    description="C4_Analyse_03f : HTTP using a port different from 80 and 8080.">
    <event value="COMPUTE" event_id="1" 
        description="HTTP packet using a port different from 80 and 8080"
           boolean_expression="((http.method != '')&amp;&amp;((tcp.dest_port != 80)&amp;&amp;(tcp.dest_port != 8080)))"/>
    <event value="COMPUTE" event_id="2" 
           description="HTTP packet"
           boolean_expression="(ip.src != ip.dst)"/>
</property>
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5044" type_property="EVASION" 
    description="C4_Analyse_03c|d|e : HTTP packet URI contains non authorised characteres according to RFC2396 and RFC2234 or possibly directory traversal attack.">
    <event value="COMPUTE" event_id="1" 
           description="HTTP URI invalid"
           boolean_expression="((http.method == http.method)&amp;&amp;(#check_URI(http.uri) == 1))"/>
    <event value="COMPUTE" event_id="2" 
           description="HTTP packet"
           boolean_expression="(ip.src != ip.dst)"/>
</property>
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5045" type_property="ATTACK" 
     description="Nikto detection" >
   <event event_id="1" value="COMPUTE" 
           description="Context: an  user agent in the HTTP header"
           boolean_expression="(#check_UA(http.user_agent) == 1)"/>
   <event event_id="2" value="COMPUTE" 
           description="Trigger: Nikto detected. "
           boolean_expression="(ip.src != ip.dst)"/>
 </property>
 
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5046" type_property="EVASION" 
    description="C4_Analyse_03f : HTTP using a port different from 80 and 8080.">
    <event value="COMPUTE" event_id="1" 
        description="HTTP packet using a port different from 80 and 8080"
           boolean_expression="((http.method != '')&amp;&amp;((tcp.dest_port != 80)&amp;&amp;(tcp.dest_port != 8080)))"/>
    <event value="COMPUTE" event_id="2" 
           description="HTTP packet"
           boolean_expression="(ip.src != ip.dst)"/>
</property>
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5047" type_property="EVASION" 
    description="C4_Analyse_03c|d|e : HTTP packet URI contains non authorised characteres according to RFC2396 and RFC2234 or possibly directory traversal attack.">
    <event value="COMPUTE" event_id="1" 
           description="HTTP URI invalid"
           boolean_expression="((http.method == http.method)&amp;&amp;(#check_URI(http.uri) == 1))"/>
    <event value="COMPUTE" event_id="2" 
           description="HTTP packet"
           boolean_expression="(ip.src != ip.dst)"/>
</property>
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5048" type_property="ATTACK" 
     description="Nikto detection" >
   <event event_id="1" value="COMPUTE" 
           description="Context: an  user agent in the HTTP header"
           boolean_expression="(#check_UA(http.user_agent) == 1)"/>
   <event event_id="2" value="COMPUTE" 
           description="Trigger: Nikto detected. "
           boolean_expression="(ip.src != ip.dst)"/>
 </property>
 
 

<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5049" type_property="EVASION" 
    description="C4_Analyse_03f : HTTP using a port different from 80 and 8080.">
    <event value="COMPUTE" event_id="1" 
        description="HTTP packet using a port different from 80 and 8080"
           boolean_expression="((http.method != '')&amp;&amp;((tcp.dest_port != 80)&amp;&amp;(tcp.dest_port != 8080)))"/>
    <event value="COMPUTE" event_id="2" 
           description="HTTP packet"
           boolean_expression="(ip.src != ip.dst)"/>
</property>
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5050" type_property="EVASION" 
    description="C4_Analyse_03c|d|e : HTTP packet URI contains non authorised characteres according to RFC2396 and RFC2234 or possibly directory traversal attack.">
    <event value="COMPUTE" event_id="1" 
           description="HTTP URI invalid"
           boolean_expression="((http.method == http.method)&amp;&amp;(#check_URI(http.uri) == 1))"/>
    <event value="COMPUTE" event_id="2" 
           description="HTTP packet"
           boolean_expression="(ip.src != ip.dst)"/>
</property>
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5051" type_property="ATTACK" 
     description="Nikto detection" >
   <event event_id="1" value="COMPUTE" 
           description="Context: an  user agent in the HTTP header"
           boolean_expression="(#check_UA(http.user_agent) == 1)"/>
   <event event_id="2" value="COMPUTE" 
           description="Trigger: Nikto detected. "
           boolean_expression="(ip.src != ip.dst)"/>
 </property>
 
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5052" type_property="EVASION" 
    description="C4_Analyse_03f : HTTP using a port different from 80 and 8080.">
    <event value="COMPUTE" event_id="1" 
        description="HTTP packet using a port different from 80 and 8080"
           boolean_expression="((http.method != '')&amp;&amp;((tcp.dest_port != 80)&amp;&amp;(tcp.dest_port != 8080)))"/>
    <event value="COMPUTE" event_id="2" 
           description="HTTP packet"
           boolean_expression="(ip.src != ip.dst)"/>
</property>
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5053" type_property="EVASION" 
    description="C4_Analyse_03c|d|e : HTTP packet URI contains non authorised characteres according to RFC2396 and RFC2234 or possibly directory traversal attack.">
    <event value="COMPUTE" event_id="1" 
           description="HTTP URI invalid"
           boolean_expression="((http.method == http.method)&amp;&amp;(#check_URI(http.uri) == 1))"/>
    <event value="COMPUTE" event_id="2" 
           description="HTTP packet"
           boolean_expression="(ip.src != ip.dst)"/>
</property>
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5054" type_property="ATTACK" 
     description="Nikto detection" >
   <event event_id="1" value="COMPUTE" 
           description="Context: an  user agent in the HTTP header"
           boolean_expression="(#check_UA(http.user_agent) == 1)"/>
   <event event_id="2" value="COMPUTE" 
           description="Trigger: Nikto detected. "
           boolean_expression="(ip.src != ip.dst)"/>
 </property>
 

<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5055" type_property="EVASION" 
    description="C4_Analyse_03f : HTTP using a port different from 80 and 8080.">
    <event value="COMPUTE" event_id="1" 
        description="HTTP packet using a port different from 80 and 8080"
           boolean_expression="((http.method != '')&amp;&amp;((tcp.dest_port != 80)&amp;&amp;(tcp.dest_port != 8080)))"/>
    <event value="COMPUTE" event_id="2" 
           description="HTTP packet"
           boolean_expression="(ip.src != ip.dst)"/>
</property>
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5056" type_property="EVASION" 
    description="C4_Analyse_03c|d|e : HTTP packet URI contains non authorised characteres according to RFC2396 and RFC2234 or possibly directory traversal attack.">
    <event value="COMPUTE" event_id="1" 
           description="HTTP URI invalid"
           boolean_expression="((http.method == http.method)&amp;&amp;(#check_URI(http.uri) == 1))"/>
    <event value="COMPUTE" event_id="2" 
           description="HTTP packet"
           boolean_expression="(ip.src != ip.dst)"/>
</property>
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5057" type_property="ATTACK" 
     description="Nikto detection" >
   <event event_id="1" value="COMPUTE" 
           description="Context: an  user agent in the HTTP header"
           boolean_expression="(#check_UA(http.user_agent) == 1)"/>
   <event event_id="2" value="COMPUTE" 
           description="Trigger: Nikto detected. "
           boolean_expression="(ip.src != ip.dst)"/>
 </property>
 
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5058" type_property="EVASION" 
    description="C4_Analyse_03f : HTTP using a port different from 80 and 8080.">
    <event value="COMPUTE" event_id="1" 
        description="HTTP packet using a port different from 80 and 8080"
           boolean_expression="((http.method != '')&amp;&amp;((tcp.dest_port != 80)&amp;&amp;(tcp.dest_port != 8080)))"/>
    <event value="COMPUTE" event_id="2" 
           description="HTTP packet"
           boolean_expression="(ip.src != ip.dst)"/>
</property>
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5059" type_property="EVASION" 
    description="C4_Analyse_03c|d|e : HTTP packet URI contains non authorised characteres according to RFC2396 and RFC2234 or possibly directory traversal attack.">
    <event value="COMPUTE" event_id="1" 
           description="HTTP URI invalid"
           boolean_expression="((http.method == http.method)&amp;&amp;(#check_URI(http.uri) == 1))"/>
    <event value="COMPUTE" event_id="2" 
           description="HTTP packet"
           boolean_expression="(ip.src != ip.dst)"/>
</property>
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5060" type_property="ATTACK" 
     description="Nikto detection" >
   <event event_id="1" value="COMPUTE" 
           description="Context: an  user agent in the HTTP header"
           boolean_expression="(#check_UA(http.user_agent) == 1)"/>
   <event event_id="2" value="COMPUTE" 
           description="Trigger: Nikto detected. "
           boolean_expression="(ip.src != ip.dst)"/>
 </property>
 
 
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5061" type_property="EVASION" 
    description="C4_Analyse_03f : HTTP using a port different from 80 and 8080.">
    <event value="COMPUTE" event_id="1" 
        description="HTTP packet using a port different from 80 and 8080"
           boolean_expression="((http.method != '')&amp;&amp;((tcp.dest_port != 80)&amp;&amp;(tcp.dest_port != 8080)))"/>
    <event value="COMPUTE" event_id="2" 
           description="HTTP packet"
           boolean_expression="(ip.src != ip.dst)"/>
</property>
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5062" type_property="EVASION" 
    description="C4_Analyse_03c|d|e : HTTP packet URI contains non authorised characteres according to RFC2396 and RFC2234 or possibly directory traversal attack.">
    <event value="COMPUTE" event_id="1" 
           description="HTTP URI invalid"
           boolean_expression="((http.method == http.method)&amp;&amp;(#check_URI(http.uri) == 1))"/>
    <event value="COMPUTE" event_id="2" 
           description="HTTP packet"
           boolean_expression="(ip.src != ip.dst)"/>
</property>
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5063" type_property="ATTACK" 
     description="Nikto detection" >
   <event event_id="1" value="COMPUTE" 
           description="Context: an  user agent in the HTTP header"
           boolean_expression="(#check_UA(http.user_agent) == 1)"/>
   <event event_id="2" value="COMPUTE" 
           description="Trigger: Nikto detected. "
           boolean_expression="(ip.src != ip.dst)"/>
 </property>
 
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5064" type_property="EVASION" 
    description="C4_Analyse_03f : HTTP using a port different from 80 and 8080.">
    <event value="COMPUTE" event_id="1" 
        description="HTTP packet using a port different from 80 and 8080"
           boolean_expression="((http.method != '')&amp;&amp;((tcp.dest_port != 80)&amp;&amp;(tcp.dest_port != 8080)))"/>
    <event value="COMPUTE" event_id="2" 
           description="HTTP packet"
           boolean_expression="(ip.src != ip.dst)"/>
</property>
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5065" type_property="EVASION" 
    description="C4_Analyse_03c|d|e : HTTP packet URI contains non authorised characteres according to RFC2396 and RFC2234 or possibly directory traversal attack.">
    <event value="COMPUTE" event_id="1" 
           description="HTTP URI invalid"
           boolean_expression="((http.method == http.method)&amp;&amp;(#check_URI(http.uri) == 1))"/>
    <event value="COMPUTE" event_id="2" 
           description="HTTP packet"
           boolean_expression="(ip.src != ip.dst)"/>
</property>
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5066" type_property="ATTACK" 
     description="Nikto detection" >
   <event event_id="1" value="COMPUTE" 
           description="Context: an  user agent in the HTTP header"
           boolean_expression="(#check_UA(http.user_agent) == 1)"/>
   <event event_id="2" value="COMPUTE" 
           description="Trigger: Nikto detected. "
           boolean_expression="(ip.src != ip.dst)"/>
 </property>
 

<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5067" type_property="EVASION" 
    description="C4_Analyse_03f : HTTP using a port different from 80 and 8080.">
    <event value="COMPUTE" event_id="1" 
        description="HTTP packet using a port different from 80 and 8080"
           boolean_expression="((http.method != '')&amp;&amp;((tcp.dest_port != 80)&amp;&amp;(tcp.dest_port != 8080)))"/>
    <event value="COMPUTE" event_id="2" 
           description="HTTP packet"
           boolean_expression="(ip.src != ip.dst)"/>
</property>
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5068" type_property="EVASION" 
    description="C4_Analyse_03c|d|e : HTTP packet URI contains non authorised characteres according to RFC2396 and RFC2234 or possibly directory traversal attack.">
    <event value="COMPUTE" event_id="1" 
           description="HTTP URI invalid"
           boolean_expression="((http.method == http.method)&amp;&amp;(#check_URI(http.uri) == 1))"/>
    <event value="COMPUTE" event_id="2" 
           description="HTTP packet"
           boolean_expression="(ip.src != ip.dst)"/>
</property>
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5069" type_property="ATTACK" 
     description="Nikto detection" >
   <event event_id="1" value="COMPUTE" 
           description="Context: an  user agent in the HTTP header"
           boolean_expression="(#check_UA(http.user_agent) == 1)"/>
   <event event_id="2" value="COMPUTE" 
           description="Trigger: Nikto detected. "
           boolean_expression="(ip.src != ip.dst)"/>
 </property>
 
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5070" type_property="EVASION" 
    description="C4_Analyse_03f : HTTP using a port different from 80 and 8080.">
    <event value="COMPUTE" event_id="1" 
        description="HTTP packet using a port different from 80 and 8080"
           boolean_expression="((http.method != '')&amp;&amp;((tcp.dest_port != 80)&amp;&amp;(tcp.dest_port != 8080)))"/>
    <event value="COMPUTE" event_id="2" 
           description="HTTP packet"
           boolean_expression="(ip.src != ip.dst)"/>
</property>
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5071" type_property="EVASION" 
    description="C4_Analyse_03c|d|e : HTTP packet URI contains non authorised characteres according to RFC2396 and RFC2234 or possibly directory traversal attack.">
    <event value="COMPUTE" event_id="1" 
           description="HTTP URI invalid"
           boolean_expression="((http.method == http.method)&amp;&amp;(#check_URI(http.uri) == 1))"/>
    <event value="COMPUTE" event_id="2" 
           description="HTTP packet"
           boolean_expression="(ip.src != ip.dst)"/>
</property>
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5072" type_property="ATTACK" 
     description="Nikto detection" >
   <event event_id="1" value="COMPUTE" 
           description="Context: an  user agent in the HTTP header"
           boolean_expression="(#check_UA(http.user_agent) == 1)"/>
   <event event_id="2" value="COMPUTE" 
           description="Trigger: Nikto detected. "
           boolean_expression="(ip.src != ip.dst)"/>
 </property>
 

<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5073" type_property="EVASION" 
    description="C4_Analyse_03f : HTTP using a port different from 80 and 8080.">
    <event value="COMPUTE" event_id="1" 
        description="HTTP packet using a port different from 80 and 8080"
           boolean_expression="((http.method != '')&amp;&amp;((tcp.dest_port != 80)&amp;&amp;(tcp.dest_port != 8080)))"/>
    <event value="COMPUTE" event_id="2" 
           description="HTTP packet"
           boolean_expression="(ip.src != ip.dst)"/>
</property>
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5074" type_property="EVASION" 
    description="C4_Analyse_03c|d|e : HTTP packet URI contains non authorised characteres according to RFC2396 and RFC2234 or possibly directory traversal attack.">
    <event value="COMPUTE" event_id="1" 
           description="HTTP URI invalid"
           boolean_expression="((http.method == http.method)&amp;&amp;(#check_URI(http.uri) == 1))"/>
    <event value="COMPUTE" event_id="2" 
           description="HTTP packet"
           boolean_expression="(ip.src != ip.dst)"/>
</property>
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5075" type_property="ATTACK" 
     description="Nikto detection" >
   <event event_id="1" value="COMPUTE" 
           description="Context: an  user agent in the HTTP header"
           boolean_expression="(#check_UA(http.user_agent) == 1)"/>
   <event event_id="2" value="COMPUTE" 
           description="Trigger: Nikto detected. "
           boolean_expression="(ip.src != ip.dst)"/>
 </property>
 
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5076" type_property="EVASION" 
    description="C4_Analyse_03f : HTTP using a port different from 80 and 8080.">
    <event value="COMPUTE" event_id="1" 
        description="HTTP packet using a port different from 80 and 8080"
           boolean_expression="((http.method != '')&amp;&amp;((tcp.dest_port != 80)&amp;&amp;(tcp.dest_port != 8080)))"/>
    <event value="COMPUTE" event_id="2" 
           description="HTTP packet"
           boolean_expression="(ip.src != ip.dst)"/>
</property>
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5077" type_property="EVASION" 
    description="C4_Analyse_03c|d|e : HTTP packet URI contains non authorised characteres according to RFC2396 and RFC2234 or possibly directory traversal attack.">
    <event value="COMPUTE" event_id="1" 
           description="HTTP URI invalid"
           boolean_expression="((http.method == http.method)&amp;&amp;(#check_URI(http.uri) == 1))"/>
    <event value="COMPUTE" event_id="2" 
           description="HTTP packet"
           boolean_expression="(ip.src != ip.dst)"/>
</property>
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5078" type_property="ATTACK" 
     description="Nikto detection" >
   <event event_id="1" value="COMPUTE" 
           description="Context: an  user agent in the HTTP header"
           boolean_expression="(#check_UA(http.user_agent) == 1)"/>
   <event event_id="2" value="COMPUTE" 
           description="Trigger: Nikto detected. "
           boolean_expression="(ip.src != ip.dst)"/>
 </property>
 

<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5079" type_property="EVASION" 
    description="C4_Analyse_03f : HTTP using a port different from 80 and 8080.">
    <event value="COMPUTE" event_id="1" 
        description="HTTP packet using a port different from 80 and 8080"
           boolean_expression="((http.method != '')&amp;&amp;((tcp.dest_port != 80)&amp;&amp;(tcp.dest_port != 8080)))"/>
    <event value="COMPUTE" event_id="2" 
           description="HTTP packet"
           boolean_expression="(ip.src != ip.dst)"/>
</property>
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5080" type_property="EVASION" 
    description="C4_Analyse_03c|d|e : HTTP packet URI contains non authorised characteres according to RFC2396 and RFC2234 or possibly directory traversal attack.">
    <event value="COMPUTE" event_id="1" 
           description="HTTP URI invalid"
           boolean_expression="((http.method == http.method)&amp;&amp;(#check_URI(http.uri) == 1))"/>
    <event value="COMPUTE" event_id="2" 
           description="HTTP packet"
           boolean_expression="(ip.src != ip.dst)"/>
</property>
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5081" type_property="ATTACK" 
     description="Nikto detection" >
   <event event_id="1" value="COMPUTE" 
           description="Context: an  user agent in the HTTP header"
           boolean_expression="(#check_UA(http.user_agent) == 1)"/>
   <event event_id="2" value="COMPUTE" 
           description="Trigger: Nikto detected. "
           boolean_expression="(ip.src != ip.dst)"/>
 </property>
 
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5082" type_property="EVASION" 
    description="C4_Analyse_03f : HTTP using a port different from 80 and 8080.">
    <event value="COMPUTE" event_id="1" 
        description="HTTP packet using a port different from 80 and 8080"
           boolean_expression="((http.method != '')&amp;&amp;((tcp.dest_port != 80)&amp;&amp;(tcp.dest_port != 8080)))"/>
    <event value="COMPUTE" event_id="2" 
           description="HTTP packet"
           boolean_expression="(ip.src != ip.dst)"/>
</property>
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5083" type_property="EVASION" 
    description="C4_Analyse_03c|d|e : HTTP packet URI contains non authorised characteres according to RFC2396 and RFC2234 or possibly directory traversal attack.">
    <event value="COMPUTE" event_id="1" 
           description="HTTP URI invalid"
           boolean_expression="((http.method == http.method)&amp;&amp;(#check_URI(http.uri) == 1))"/>
    <event value="COMPUTE" event_id="2" 
           description="HTTP packet"
           boolean_expression="(ip.src != ip.dst)"/>
</property>
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5084" type_property="ATTACK" 
     description="Nikto detection" >
   <event event_id="1" value="COMPUTE" 
           description="Context: an  user agent in the HTTP header"
           boolean_expression="(#check_UA(http.user_agent) == 1)"/>
   <event event_id="2" value="COMPUTE" 
           description="Trigger: Nikto detected. "
           boolean_expression="(ip.src != ip.dst)"/>
 </property>
 

<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5085" type_property="EVASION" 
    description="C4_Analyse_03f : HTTP using a port different from 80 and 8080.">
    <event value="COMPUTE" event_id="1" 
        description="HTTP packet using a port different from 80 and 8080"
           boolean_expression="((http.method != '')&amp;&amp;((tcp.dest_port != 80)&amp;&amp;(tcp.dest_port != 8080)))"/>
    <event value="COMPUTE" event_id="2" 
           description="HTTP packet"
           boolean_expression="(ip.src != ip.dst)"/>
</property>
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5086" type_property="EVASION" 
    description="C4_Analyse_03c|d|e : HTTP packet URI contains non authorised characteres according to RFC2396 and RFC2234 or possibly directory traversal attack.">
    <event value="COMPUTE" event_id="1" 
           description="HTTP URI invalid"
           boolean_expression="((http.method == http.method)&amp;&amp;(#check_URI(http.uri) == 1))"/>
    <event value="COMPUTE" event_id="2" 
           description="HTTP packet"
           boolean_expression="(ip.src != ip.dst)"/>
</property>
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5087" type_property="ATTACK" 
     description="Nikto detection" >
   <event event_id="1" value="COMPUTE" 
           description="Context: an  user agent in the HTTP header"
           boolean_expression="(#check_UA(http.user_agent) == 1)"/>
   <event event_id="2" value="COMPUTE" 
           description="Trigger: Nikto detected. "
           boolean_expression="(ip.src != ip.dst)"/>
 </property>
 
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5088" type_property="EVASION" 
    description="C4_Analyse_03f : HTTP using a port different from 80 and 8080.">
    <event value="COMPUTE" event_id="1" 
        description="HTTP packet using a port different from 80 and 8080"
           boolean_expression="((http.method != '')&amp;&amp;((tcp.dest_port != 80)&amp;&amp;(tcp.dest_port != 8080)))"/>
    <event value="COMPUTE" event_id="2" 
           description="HTTP packet"
           boolean_expression="(ip.src != ip.dst)"/>
</property>
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5089" type_property="EVASION" 
    description="C4_Analyse_03c|d|e : HTTP packet URI contains non authorised characteres according to RFC2396 and RFC2234 or possibly directory traversal attack.">
    <event value="COMPUTE" event_id="1" 
           description="HTTP URI invalid"
           boolean_expression="((http.method == http.method)&amp;&amp;(#check_URI(http.uri) == 1))"/>
    <event value="COMPUTE" event_id="2" 
           description="HTTP packet"
           boolean_expression="(ip.src != ip.dst)"/>
</property>
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5090" type_property="ATTACK" 
     description="Nikto detection" >
   <event event_id="1" value="COMPUTE" 
           description="Context: an  user agent in the HTTP header"
           boolean_expression="(#check_UA(http.user_agent) == 1)"/>
   <event event_id="2" value="COMPUTE" 
           description="Trigger: Nikto detected. "
           boolean_expression="(ip.src != ip.dst)"/>
 </property>
 

<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5091" type_property="EVASION" 
    description="C4_Analyse_03f : HTTP using a port different from 80 and 8080.">
    <event value="COMPUTE" event_id="1" 
        description="HTTP packet using a port different from 80 and 8080"
           boolean_expression="((http.method != '')&amp;&amp;((tcp.dest_port != 80)&amp;&amp;(tcp.dest_port != 8080)))"/>
    <event value="COMPUTE" event_id="2" 
           description="HTTP packet"
           boolean_expression="(ip.src != ip.dst)"/>
</property>
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5092" type_property="EVASION" 
    description="C4_Analyse_03c|d|e : HTTP packet URI contains non authorised characteres according to RFC2396 and RFC2234 or possibly directory traversal attack.">
    <event value="COMPUTE" event_id="1" 
           description="HTTP URI invalid"
           boolean_expression="((http.method == http.method)&amp;&amp;(#check_URI(http.uri) == 1))"/>
    <event value="COMPUTE" event_id="2" 
           description="HTTP packet"
           boolean_expression="(ip.src != ip.dst)"/>
</property>
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5093" type_property="ATTACK" 
     description="Nikto detection" >
   <event event_id="1" value="COMPUTE" 
           description="Context: an  user agent in the HTTP header"
           boolean_expression="(#check_UA(http.user_agent) == 1)"/>
   <event event_id="2" value="COMPUTE" 
           description="Trigger: Nikto detected. "
           boolean_expression="(ip.src != ip.dst)"/>
 </property>
 
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5094" type_property="EVASION" 
    description="C4_Analyse_03f : HTTP using a port different from 80 and 8080.">
    <event value="COMPUTE" event_id="1" 
        description="HTTP packet using a port different from 80 and 8080"
           boolean_expression="((http.method != '')&amp;&amp;((tcp.dest_port != 80)&amp;&amp;(tcp.dest_port != 8080)))"/>
    <event value="COMPUTE" event_id="2" 
           description="HTTP packet"
           boolean_expression="(ip.src != ip.dst)"/>
</property>
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5095" type_property="EVASION" 
    description="C4_Analyse_03c|d|e : HTTP packet URI contains non authorised characteres according to RFC2396 and RFC2234 or possibly directory traversal attack.">
    <event value="COMPUTE" event_id="1" 
           description="HTTP URI invalid"
           boolean_expression="((http.method == http.method)&amp;&amp;(#check_URI(http.uri) == 1))"/>
    <event value="COMPUTE" event_id="2" 
           description="HTTP packet"
           boolean_expression="(ip.src != ip.dst)"/>
</property>
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5096" type_property="ATTACK" 
     description="Nikto detection" >
   <event event_id="1" value="COMPUTE" 
           description="Context: an  user agent in the HTTP header"
           boolean_expression="(#check_UA(http.user_agent) == 1)"/>
   <event event_id="2" value="COMPUTE" 
           description="Trigger: Nikto detected. "
           boolean_expression="(ip.src != ip.dst)"/>
 </property>
 

<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5097" type_property="EVASION" 
    description="C4_Analyse_03f : HTTP using a port different from 80 and 8080.">
    <event value="COMPUTE" event_id="1" 
        description="HTTP packet using a port different from 80 and 8080"
           boolean_expression="((http.method != '')&amp;&amp;((tcp.dest_port != 80)&amp;&amp;(tcp.dest_port != 8080)))"/>
    <event value="COMPUTE" event_id="2" 
           description="HTTP packet"
           boolean_expression="(ip.src != ip.dst)"/>
</property>
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5098" type_property="EVASION" 
    description="C4_Analyse_03c|d|e : HTTP packet URI contains non authorised characteres according to RFC2396 and RFC2234 or possibly directory traversal attack.">
    <event value="COMPUTE" event_id="1" 
           description="HTTP URI invalid"
           boolean_expression="((http.method == http.method)&amp;&amp;(#check_URI(http.uri) == 1))"/>
    <event value="COMPUTE" event_id="2" 
           description="HTTP packet"
           boolean_expression="(ip.src != ip.dst)"/>
</property>
<property value="THEN" delay_units="s" delay_min="0" delay_max="0" property_id="5099" type_property="ATTACK" 
     description="Nikto detection" >
   <event event_id="1" value="COMPUTE" 
           description="Context: an  user agent in the HTTP header"
           boolean_expression="(#check_UA(http.user_agent) == 1)"/>
   <event event_id="2" value="COMPUTE" 
           description="Trigger: Nikto detected. "
           boolean_expression="(ip.src != ip.dst)"/>
 </property>
 
</beginning>
