<beginning>
<!-- Property 36: Detection of robot, crawler, spider, spam and bad bot based on blacklisted User-Agent strings (hash-table). 
528 signatures from the source: http://www.user-agents.org/ 
-->
<property value="THEN" delay_units="ms" delay_min="0" delay_max="0" property_id="36" type_property="ATTACK" 
    description="Detection of robot, crawler, spider, spam and bad bot based on blacklisted User-Agent strings (hash-table)">
    <event value="COMPUTE" event_id="1" 
           description="HTTP User-Agent string representing robot, crawler, spider, spam and bad bot"
           boolean_expression="(#em_check_malicious_UA(http.user_agent) == true)"/>
    <event value="COMPUTE" event_id="2" 
           description="HTTP GET"
           boolean_expression="((http.method == 'GET') &amp;&amp; (ip.src != ip.dst))"/> 
</property>

<embedded_functions><![CDATA[
static mmt_hash_t *table = NULL;

static inline int em_check_malicious_UA(const char * UA){
   return( mmt_hash_search( table, UA, strlen( UA )) != NULL );
}
	
static const char *list_malicious_UA[] = {
"*/Nutch-0.9-dev",
"192.comAgent",
"4anything.com LinkChecker v2.0",
"8484 Boston Project v 1.0",
"A-Online Search",
"aardvark-crawler",
"AbachoBOT",
"AbachoBOT (Mozilla compatible)",
"ABCdatos BotLink/5.xx.xxx#BBL",
"Aberja Checkomat",
"About/0.1libwww-perl/5.47",
"Accelatech RSSCrawler/0.4",
"accoona",
"Ack (http://www.ackerm.com/)",
"AcoiRobot",
"Acoon Robot v1.50.001",
"AESOP_com_SpiderMan",
"AgentName/0.1 libwww-perl/5.48",
"Aladin/3.324",
"AlkalineBOT/1.3",
"Allesklar/0.1 libwww-perl/5.46",
"Allrati/1.1 (+)",
"AmfibiBOT",
"amibot",
"antibot-V1.1.5/i586-linux-2.2",
"Apexoo Spider 1.x",
"Aport",
"appie 1.1 (www.walhello.com)",
"ArachBot",
"ArchitextSpider",
"archive.org_bot",
"Arikus_Spider",
"Asahina-Antenna/1.x",
"ask.24x.info",
"ASPSeek/1.2.5",
"ASPseek/1.2.9d",
"ASPSeek/1.2.x",
"ASPSeek/1.2.xa",
"ASPseek/1.2.xx",
"ASPSeek/1.2.xxpre",
"ASSORT/0.10",
"asterias/2.0",
"Atomic_Email_Hunter/4.0",
"Atomz/1.0",
"atSpider/1.0",
"augurfind",
"augurnfind V-1.x",
"autoemailspider",
"AV Fetch 1.0",
"AVSearch-3.0(AltaVista/AVC)",
"BaiDuSpider",
"bdcindexer_2.6.2 (research@bdc)",
"BDFetch",
"BIGLOTRON (Beta 2;GNU/Linux)",
"Bitacle bot/1.1",
"BlackWidow",
"BlitzBOT@tricus.net",
"BlogBot/1.x",
"Blogpulse (info@blogpulse.com)",
"blogsearchbot-pumpkin-3",
"BloobyBot",
"boitho.com-robot/1.x",
"BSDSeek/1.0",
"BullsEye",
"bumblebee@relevare.com",
"bwh3_user_agent",
"carleson/1.0",
"Catall Spider",
"ccubee/x.x",
"cfetch/1.0",
"China Local Browse 2.6",
"ChristCRAWLER 2.0",
"ClariaBot/1.0",
"Claymont.com",
"combine/0.0",
"Combine/x.0",
"ContactBot/0.2",
"ContentSmartz",
"Convera Internet Spider V6.x",
"ConveraCrawler/0.2",
"CoolBot",
"cosmos/0.8_(robot@xyleme.com)",
"cosmos/0.9_(robot@xyleme.com)",
"Covac TexAs Arachbot",
"Crawler admin@crawler.de",
"crawler@alexa.com",
"CrawlerBoy Pinpoint.com",
"csci_b659/0.13",
"CurryGuide SiteScan 1.1",
"DataCha0s/2.0",
"DataFountains/DMOZ Downloader",
"daypopbot/0.x",
"DBrowse 1.4b",
"DBrowse 1.4d",
"dCSbot/1.1",
"deepak-USC/ISI",
"DeepIndex",
"DeepIndexer.ca",
"Demo Bot DOT 16b",
"Demo Bot Z 16b",
"Diamond/x.0",
"DiamondBot",
"Digger/1.0 JDK/1.3.0rc3",
"DigOut4U",
"DIIbot/1.2",
"DittoSpyder",
"dloader(NaverRobot)/1.0",
"DoCoMo/1.0/Nxxxi/c10",
"DoCoMo/1.0/Nxxxi/c10/TB",
"dodgebot/experimental",
"DSurf15a 01",
"DSurf15a 71",
"DSurf15a 81",
"DSurf15a VA",
"dtSearchSpider",
"Dumbot(version 0.1 beta)",
"EasyDL/3.xx",
"EBrowse 1.4b",
"EchO!/2.0",
"Educate Search VxB",
"ejupiter.com",
"EmailSiphon",
"EmailSpider",
"EmailWolf 1.00",
"EMPAS_ROBOT",
"Enfish Tracker",
"Enterprise_Search/1.0",
"Enterprise_Search/1.0.xxx",
"EroCrawler",
"ESISmartSpider",
"ESurf15a 15",
"EvaalSE - bot@evaal.com",
"Exabot-Images/1.0",
"Exabot-Test/1.0",
"Exabot/2.0",
"Exabot/3.0",
"ExactSeek Crawler/0.1",
"exactseek.com",
"ExperimentalHenrytheMiragoRobot",
"ExtractorPro",
"Fast Crawler Gold Edition",
"Fast PartnerSite Crawler",
"FAST-WebCrawler/3.2 test",
"FAST-WebCrawler/3.x Multimedia",
"FastBug http://www.ay-up.com",
"Faxobot/1.0",
"Feed24.com",
"FeedChecker/0.01",
"Feedjit Favicon Crawler 1.0",
"FFC Trap Door Spider",
"Filtrbox/1.0",
"FineBot",
"Firefly/1.0",
"firstsbot",
"Flexum spider",
"Flexum/2.0",
"flunky",
"FocusedSampler/1.0",
"Franklin Locator 1.8",
"FSurf15a 01",
"Full Web Bot 0416B",
"Full Web Bot 0516B",
"Full Web Bot 2816B",
"FuseBulb.Com",
"GAIS Robot/1.0B2",
"GammaSpider/1.0",
"gazz/x.x (gazz@nttrd.com)",
"generic_crawler/01.0217/",
"geniebot wgao@genieknows.com",
"Gigabot/2.0 (gigablast.com)",
"Gigabot/2.0att",
"Gigabot/x.0",
"GNODSPIDER (www.gnod.net)",
"GoForIt.com",
"Goofer/0.2",
"Googlebot-Image/1.0",
"GrapeFX/0.3 libwww/5.4.0",
"Gromit/1.0",
"grub-client",
"Guestbook Auto Submitter",
"Gulliver/1.3",
"HappyFunBot/1.1",
"Harvest-NG/1.0.2",
"Hatena Pagetitle Agent/1.0",
"HeinrichderMiragoRobot",
"HenrytheMiragoRobot",
"Hippias/0.9 Beta",
"HitList",
"holmes/3.9 (onet.pl)",
"holmes/x.x",
"HolmesBot (http://holmes.ge)",
"Homerbot: www.homerweb.com",
"HPL/Nutch-0.9 -",
"htdig/3.1.x (root@localhost)",
"http://www.monogol.de",
"IAArchiver-1.0",
"ia_archiver",
"ia_archiver-web.archive.org",
"ia_archiver/1.6",
"ichiro/x.0 (ichiro@nttr.co.jp)",
"ICRA_label_spider/x.0",
"icsbot-0.1",
"ideare - SignSite/1.x",
"ilial/Nutch-0.9-dev",
"IlseBot/1.x",
"IncyWincy(http://www.look.com)",
"IndexTheWeb.com Crawler7",
"Industry Program 1.0.x",
"Inet library",
"INFOMINE/8.0 Adders",
"INFOMINE/8.0 RemoteServices",
"InfoNaviRobot(F107)",
"InfoSeek Sidewinder/0.9",
"InfoSeek Sidewinder/1.0A",
"InfoSeek Sidewinder/1.1A",
"Inktomi Search",
"Insitornaut",
"Internet Ninja x.0",
"InternetSeer.com",
"IPiumBot laurion(dot)com",
"ISC Systems iRc Search 2.1",
"IUPUI Research Bot v 1.9a",
"Jack",
"Jetbot/1.0",
"JobSpider_BA/1.1",
"Jyxobot/x",
"k2spider",
"KAIST AITrc Crawler",
"Kenjin Spider",
"Kevin http://dznet.com/kevin/",
"KE_1.0/2.0 libwww/5.2.8",
"kinjabot (http://www.kinja.com)",
"KIT-Fireball/2.0",
"Knowledge.com/0.x",
"kuloko-bot/0.x",
"kulturarw3/0.1",
"larbin (samualt9@bigfoot.com)",
"LECodeChecker/3.0 libgetdoc/1.0",
"LEIA/2.90",
"LexiBot/1.00",
"Libby_1.1/libwww-perl/5.47",
"LibertyW (+http://www.lw01.com)",
"libwww-perl/5.41",
"libwww-perl/5.45",
"libwww-perl/5.48",
"libwww-perl/5.52 FP/2.1",
"libwww-perl/5.52 FP/4.0",
"libwww-perl/5.65",
"libwww-perl/5.800",
"libwww/5.3.2",
"Lincoln State Web Browser",
"linkbot",
"linknzbot",
"LinkScan/9.0g Unix",
"LinkScan/x.x Unix",
"LMQueueBot/0.2",
"LNSpiderguy",
"Lockstep Spider/1.0",
"Look.com",
"lwp-trivial/1.32",
"lwp-trivial/1.34",
"LWP::Simple/5.22",
"LWP::Simple/5.36",
"LWP::Simple/5.48",
"LWP::Simple/5.50",
"LWP::Simple/5.51",
"LWP::Simple/5.53",
"LWP::Simple/5.63",
"LWP::Simple/5.803",
"Lycos_Spider_(modspider)",
"Lycos_Spider_(T-Rex)",
"Mac Finder 1.0.xx",
"Mail.Ru/1.0",
"mailto:webcraft@bea.com",
"MantraAgent",
"Marketwave Hit List",
"Martini",
"MARTINI",
"Marvin v0.3",
"MasterSeek",
"Mata Hari/2.00 ",
"MediaCrawler-1.0 (Experimental)",
"MediaSearch/0.1",
"Mercator-1.x",
"Mercator-2.0",
"MetaGer-LinkChecker",
"MetaGer_PreChecker0.1",
"MicroBaz",
"Missauga Locate 1.0.0",
"Missigua Locator 1.9",
"Missouri College Browse",
"Miva (AlgoFeedback@miva.com)",
"Mizzu Labs 2.2",
"MJBot (SEO assessment)",
"MLBot (www.metadatalabs.com)",
"MnogoSearch/3.2.xx",
"Mo College 1.9",
"moget/x.x (moget@goo.ne.jp)",
"mogimogi/1.0",
"Mozilla (Mozilla@somewhere.com)",
"Mozilla/4.0 (Sleek Spider/1.2)",
"Mozilla/4.0 efp@gmx.net",
"Mozilla/5.0 URL-Spider",
"Mozilla/5.0 wgao@genieknows.com",
"MSNPTC/1.0",
"MultiText/0.1",
"MVAClient",
"Mylinea.com Crawler 2.0",
"NABOT/5.0",
"nabot_1.0",
"NameOfAgent (CMS Spider)",
"NASA Search 1.0",
"NationalDirectory-WebSpider/1.3",
"NationalDirectoryAddURL/1.0",
"NaverBot_dloader/1.5",
"NavissoBot",
"NetLookout/2.24",
"NetNoseCrawler/v1.0",
"Netprospector JavaCrawler",
"NetSprint -- 2.0",
"NetZippy",
"NG/1.0",
"NG/4.0.1229",
"NITLE Blog Spider/0.01",
"Noago Spider",
"Norbert the Spider(Burf.com)",
"noyona_0_1",
"NPBot-1/2.0",
"Nsauditor/1.x",
"Nutch",
"oBot ((compatible;Win32))",
"Octora Beta - www.octora.com",
"OntoSpider/1.0 libwww-perl/5.65",
"Openfind Robot/1.1A2",
"OpenTextSiteCrawler/2.9.2",
"OpenWebSpider/x",
"Oracle Ultra Search",
"OrangeSpider",
"PADLibrary Spider",
"PBrowse 1.4b",
"PEERbot www.peerbot.com",
"PEval 1.4b",
"PicoSearch/1.0",
"Piffany_Web_Scraper_v0.x",
"Piffany_Web_Spider_v0.x",
"Pita",
"PlagiarBot/1.0",
"Poirot",
"Pompos/1.x pompos@iliad.fr",
"Popdexter/1.0",
"Port Huron Labs",
"potbot 1.0",
"PrivacyFinder Cache Bot v1.0",
"PrivacyFinder/1.1",
"Production Bot 0116B",
"Production Bot 2016B",
"Production Bot DOT 3016B",
"Program Shareware 1.0.2",
"Project XP5 [2.03.07-111203]",
"PROve AnswerBot 4.0",
"PSurf15a 11",
"PSurf15a 51",
"PSurf15a VA",
"psycheclone",
"pulseBot (pulse Web Miner)",
"PycURL",
"Python-urllib/1.1x",
"Python-urllib/2.0a1",
"QuepasaCreep v0.9.1x",
"QueryN Metasearch",
"ramBot xtreme x.x",
"Rational SiteCheck (Windows NT)",
"rico/0.1",
"Robot/www.pj-search.com",
"Robot@SuperSnooper.Com",
"Robozilla/1.0",
"Rotondo/3.1 libwww/5.3.1",
"RRC (crawler_admin@bigfoot.com)",
"RSurf15a 41",
"RSurf15a 51",
"RSurf15a 81",
"savvybot/0.2",
"ScanWeb",
"Scooter-3.0.EU",
"Scooter-3.0.FS",
"Scooter-3.0.HD",
"Scooter-3.0.VNS",
"Scooter-3.0QI",
"Scooter-3.2",
"Scooter-3.2.BT",
"Scooter-3.2.DIL",
"Scooter-3.2.EX",
"Scooter-3.2.JT",
"Scooter-3.2.NIV",
"Scooter-3.2.SF0",
"Scooter-3.2.snippet",
"Scooter-3.3dev",
"Scooter-ARS-1.1",
"Scooter-ARS-1.1-ih",
"scooter-venus-3.0.vns",
"Scooter-W3-1.0",
"Scooter-W3.1.2",
"Scooter/1.0",
"Scooter/1.0 scooter@pa.dec.com",
"Scooter/1.1 (custom)",
"Scooter/2.0 G.R.A.B. V1.1.0",
"Scooter/2.0 G.R.A.B. X2.0",
"Scooter/3.3",
"Scooter/3.3.QA.pczukor",
"Scooter/3.3.vscooter",
"Scooter/3.3_SF",
"Scooter2_Mercator_x-x.0",
"Scooter_bh0-3.0.3",
"Scooter_trk3-3.0.3",
"ScoutAbout",
"scoutmaster",
"Search+",
"Search-Engine-Studio",
"search.ch V1.4",
"searchbot admin@google.com",
"SearchdayBot",
"SearchExpress Spider0.99",
"Searchmee! Spider v0.98a",
"SearchSpider.com/1.1",
"SearchTone2.0 - IDEARE",
"Seeker.lookseek.com",
"SeznamBot/1.0",
"ShablastBot 1.0",
"Shim Crawler",
"Shoula.com Crawler 2.0",
"silk/1.0",
"SiteXpert",
"Slarp/0.1",
"Slider_Search_v1-de",
"Slurpy Verifier/1.0",
"smartwit.com",
"SmiffyDCMetaSpider/1.0",
"snap.com beta crawler v0",
"Snapbot/1.0",
"SocSciBot ()",
"sogou develop spider",
"sogou spider",
"sohu agent",
"sohu-search",
"speedfind ramBot xtreme 8.1",
"Sphider",
"Spida/0.1",
"spider.batsch.com",
"SpiderKU/0.x",
"SpiderMan",
"Spinne/2.0",
"Spinne/2.0 med",
"Spinne/2.0 med_AH",
"SSurf15a 11 ",
"StackRambler/x.x ",
"stat statcrawler@gmail.com",
"suchbaer.de",
"suchbot",
"Suchknecht.at-Robot",
"SurferF3 1/0",
"suzuran",
"SygolBot http://www.sygol.net",
"SynoBot",
"Szukacz/1.x",
"TECOMAC-Crawler/0.x",
"Teoma MP",
"teoma_agent1",
"Test spider",
"TheSuBot/0.1 (www.thesubot.de)",
"TJG/Spider",
"Trampelpfad-Spider",
"Trampelpfad-Spider-v0.1",
"TSurf15a 11",
"Tycoon Agent/Nutch-1.0-dev",
"TygoBot",
"TygoProwler",
"UIowaCrawler/1.0",
"Ultraseek",
"Under the Rainbow 2.2",
"Uptimebot",
"UptimeBot(www.uptimebot.com)",
"URL_Spider_Pro/x.x",
"VadixBot",
"Vagabondo/2.0 MT",
"Vespa Crawler",
"voyager-hc/1.0",
"voyager/1.0",
"vspider",
"vspider/3.x",
"Web Snooper",
"webbandit/4.xx.0",
"Webclipping.com",
"WebCompass 2.0",
"WebCorp/1.0",
"webcrawl.net",
"Weblog Attitude Diffusion 1.0",
"WebsiteWorth v1.0",
"Websquash.com (Add url robot)",
"Wells Search II",
"WEP Search 00",
"WFARC",
"whatUseek_winona/3.0",
"WhizBang! Lab",
"WinHTTP Example/1.0",
"WorldLight",
"Wwlib/Linux",
"www.arianna.it",
"X-Crawler ",
"xyro_(xcrawler@cosmos.inria.fr)",
"Y!J-SRD/1.0",
"Yahoo Pipes 1.0",
"Yahoo! Mindset",
"Yahoo-Test/4.0",
"yarienavoir.net/0.2",
"Yeti",
"yoogliFetchAgent/0.1",
"yoono/1.0 web-crawler/1.0",
"Zao-Crawler",
"Zao-Crawler 0.2b",
"ZBot/1.00 (icaulfield@zeus.com)",
"Zearchit",
"ZeBot_lseek.net (bot@ze.bz)",
"Zippy v2.0 - Zippyfinder.com",
"ZoomSpider - wrensoft.com"
};
	
 //This fuction is called when the rules in this file being loaded into MMT-Security
void on_load(){
	int i;
   //number of uri
   int length = sizeof( list_malicious_UA ) / sizeof( list_malicious_UA[0] );
   const char* uri;
   
   //create a new hash table
   table = mmt_hash_create( length );
   mmt_debug("Rule 36.robot_user: Created a table for checking robot having %d user-agents", length );
   
   //add items to the hash table
   for( i=0; i<length; i++ ){
      uri = list_malicious_UA[i];
      mmt_hash_add( table, uri, strlen(uri), (void*) uri, false );
   }
}//end on_load()

//This fuction is called when exiting MMT-Security
void on_unload(){
   mmt_hash_free( table );
}//end on_unload()
]]></embedded_functions>
</beginning>